<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.control.cell.PropertyValueFactory?>
<?import org.kordamp.ikonli.javafx.FontIcon?>

<VBox xmlns="http://javafx.com/javafx/24.0.1"
      fx:controller="com.wakeb.yusradmin.controllers.OverviewController"
      xmlns:fx="http://javafx.com/fxml/1"
      alignment="TOP_RIGHT" spacing="12" nodeOrientation="RIGHT_TO_LEFT"
      stylesheets="@../../../css/main.css">

    <HBox alignment="CENTER_RIGHT">
        <Label styleClass="title" text="نظرة عامة" />
        <Region HBox.hgrow="ALWAYS"/>
        <Button styleClass="button" text="تحديث" onAction="#refreshData">
            <graphic>
                <FontIcon iconLiteral="fas-sync-alt" iconSize="14" />
            </graphic>
        </Button>
    </HBox>

    <VBox spacing="20" style="-fx-padding: 20;">
        <!-- Statistics Cards -->
        <HBox spacing="20" alignment="CENTER_RIGHT">
            <!-- Users Card -->
            <VBox styleClass="stat-card">
                <HBox alignment="CENTER" spacing="10">
                    <FontIcon iconLiteral="fas-users" iconSize="24" styleClass="stat-icon" />
                    <Label text="عدد الحسابات المسجلة" styleClass="stat-title"/>
                </HBox>
                <Label fx:id="registeredUsersLabel" text="0 حساب" styleClass="stat-value"/>
            </VBox>

            <!-- Reviews Card -->
            <VBox styleClass="stat-card">
                <HBox alignment="CENTER" spacing="10">
                    <FontIcon iconLiteral="fas-star" iconSize="24" styleClass="stat-icon" />
                    <Label text="إجمالي التعليقات" styleClass="stat-title"/>
                </HBox>
                <Label fx:id="totalReviewsLabel" text="0 تعليق" styleClass="stat-value"/>
            </VBox>

            <!-- Places Card -->
            <VBox styleClass="stat-card">
                <HBox alignment="CENTER" spacing="10">
                    <FontIcon iconLiteral="fas-map-marker-alt" iconSize="24" styleClass="stat-icon" />
                    <Label text="إجمالي الأماكن" styleClass="stat-title"/>
                </HBox>
                <Label fx:id="totalPlacesLabel" text="0 مكان" styleClass="stat-value"/>
            </VBox>

            <!-- Rating Card -->
            <VBox styleClass="stat-card">
                <HBox alignment="CENTER" spacing="10">
                    <FontIcon iconLiteral="fas-chart-line" iconSize="24" styleClass="stat-icon" />
                    <Label text="متوسط التقييمات" styleClass="stat-title"/>
                </HBox>
                <Label fx:id="avgRatingLabel" text="0.0" styleClass="stat-value"/>
            </VBox>
        </HBox>

        <!-- Category Statistics Row -->
        <HBox spacing="20" alignment="CENTER_RIGHT">
            <!-- Places by Category -->
            <VBox styleClass="section-card" prefWidth="350">
                <HBox alignment="CENTER_RIGHT" spacing="10">
                    <FontIcon iconLiteral="fas-layer-group" iconSize="20" />
                    <Label text="الأماكن حسب الفئة" styleClass="section-title"/>
                </HBox>
                <TableView fx:id="placesByCategoryTable" style="-fx-max-height: 200;">
                    <columns>
                        <TableColumn text="الفئة" prefWidth="200">
                            <cellValueFactory><PropertyValueFactory property="category"/></cellValueFactory>
                        </TableColumn>
                        <TableColumn text="العدد" prefWidth="100">
                            <cellValueFactory><PropertyValueFactory property="count"/></cellValueFactory>
                        </TableColumn>
                    </columns>
                </TableView>
            </VBox>

            <!-- Reviews by Category -->
            <VBox styleClass="section-card" prefWidth="350">
                <HBox alignment="CENTER_RIGHT" spacing="10">
                    <FontIcon iconLiteral="fas-chart-bar" iconSize="20" />
                    <Label text="التقييمات حسب الفئة" styleClass="section-title"/>
                </HBox>
                <TableView fx:id="reviewsByCategoryTable" style="-fx-max-height: 200;">
                    <columns>
                        <TableColumn text="الفئة" prefWidth="200">
                            <cellValueFactory><PropertyValueFactory property="category"/></cellValueFactory>
                        </TableColumn>
                        <TableColumn text="العدد" prefWidth="100">
                            <cellValueFactory><PropertyValueFactory property="count"/></cellValueFactory>
                        </TableColumn>
                    </columns>
                </TableView>
            </VBox>
        </HBox>

        <!-- Latest Reviews -->
        <VBox styleClass="section-card">
            <HBox alignment="CENTER_RIGHT" spacing="10">
                <FontIcon iconLiteral="fas-clock" iconSize="20" />
                <Label text="أحدث التعليقات" styleClass="section-title"/>
            </HBox>
            <TableView fx:id="reviewsTableView" style="-fx-max-height: 300;">
                <columns>
                    <TableColumn text="المستخدم" prefWidth="120">
                        <cellValueFactory><PropertyValueFactory property="userName"/></cellValueFactory>
                    </TableColumn>
                    <TableColumn text="المكان" prefWidth="150">
                        <cellValueFactory><PropertyValueFactory property="placeName"/></cellValueFactory>
                    </TableColumn>
                    <TableColumn text="التعليق" prefWidth="200">
                        <cellValueFactory><PropertyValueFactory property="description"/></cellValueFactory>
                    </TableColumn>
                    <TableColumn text="التقييم" prefWidth="80">
                        <cellValueFactory><PropertyValueFactory property="rating"/></cellValueFactory>
                    </TableColumn>
                    <TableColumn text="التاريخ" prefWidth="120">
                        <cellValueFactory><PropertyValueFactory property="createdAt"/></cellValueFactory>
                    </TableColumn>
                </columns>
            </TableView>
        </VBox>
    </VBox>
</VBox>