<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.Cursor?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ProgressIndicator?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.cell.PropertyValueFactory?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>
<?import org.kordamp.ikonli.javafx.FontIcon?>

<AnchorPane stylesheets="@../../../css/main.css" xmlns="http://javafx.com/javafx/24.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.wakeb.yusradmin.controllers.OverviewController">

    <!-- Scrollable Content -->
    <ScrollPane fitToHeight="true" fitToWidth="true" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0">
        <content>
            <VBox alignment="TOP_RIGHT" nodeOrientation="RIGHT_TO_LEFT" spacing="12">

                <!-- Header -->
                <HBox alignment="CENTER_RIGHT" prefHeight="60">
                    <Label prefHeight="126.0" prefWidth="1020.0" styleClass="title" text="نظرة عامة">
                        <HBox.margin><Insets left="30.0" /></HBox.margin>
                    </Label>
                    <Region HBox.hgrow="ALWAYS" />
                    <Button onAction="#refreshData" prefHeight="38.0" prefWidth="114.0" styleClass="button" text="تحديث">
                        <HBox.margin><Insets right="20.0" /></HBox.margin>
                    </Button>
                </HBox>

                <!-- Top Stats Row -->
                <HBox fillHeight="true" spacing="20" style="-fx-padding: 0 20 20 20;" VBox.vgrow="NEVER">
                    <!-- Users Card -->
                    <VBox alignment="TOP_RIGHT" maxWidth="Infinity" styleClass="stat-card" HBox.hgrow="ALWAYS">
                        <Label alignment="TOP_LEFT" contentDisplay="TOP" nodeOrientation="RIGHT_TO_LEFT" styleClass="stat-title" text="عدد الحسابات المسجلة" textAlignment="RIGHT">
                            <cursor><Cursor fx:constant="NONE" /></cursor>
                        </Label>
                        <Label fx:id="registeredUsersLabel" alignment="TOP_LEFT" styleClass="stat-num-value" text="0">
                            <font><Font size="46.0" /></font>
                        </Label>
                        <Label fx:id="registeredUsersLabel1" alignment="TOP_LEFT" styleClass="stat-value" text="حساب" />
                    </VBox>

                    <!-- Reviews Card -->
                    <VBox alignment="TOP_RIGHT" maxWidth="Infinity" styleClass="stat-card" HBox.hgrow="ALWAYS">
                        <Label contentDisplay="RIGHT" styleClass="stat-title" text="إجمالي التعليقات" textAlignment="RIGHT" />
                        <Label fx:id="totalReviewsLabel" alignment="TOP_LEFT" styleClass="stat-num-value" text="0" />
                        <Label fx:id="totalReviewsLabel1" alignment="TOP_LEFT" styleClass="stat-value" text="تعليق" />
                    </VBox>

                    <!-- Places Card -->
                    <VBox alignment="TOP_RIGHT" maxWidth="Infinity" styleClass="stat-card" HBox.hgrow="ALWAYS">
                        <Label contentDisplay="RIGHT" styleClass="stat-title" text="إجمالي الأماكن" textAlignment="RIGHT" />
                        <Label fx:id="totalPlacesLabel" alignment="TOP_LEFT" styleClass="stat-num-value" text="0" />
                        <Label fx:id="totalPlacesLabel1" alignment="TOP_LEFT" styleClass="stat-value" text="مكان" />
                    </VBox>
                </HBox>

                <!-- Charts Row -->
                <HBox alignment="CENTER" fillHeight="true" spacing="20" style="-fx-padding: 0 20 20 20;">
                    <!-- Category Chart -->
                    <VBox maxHeight="Infinity" maxWidth="Infinity" minHeight="450" minWidth="450" styleClass="section-card" HBox.hgrow="ALWAYS" VBox.vgrow="ALWAYS">
                        <HBox spacing="10">
                            <FontIcon iconLiteral="fas-layer-group" iconSize="20" />
                            <Label styleClass="section-title" text="الأماكن حسب الفئة" />
                        </HBox>
                        <AnchorPane VBox.vgrow="ALWAYS">
                            <StackPane fx:id="chartHost" style="-fx-background-color: transparent;" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0">
                                <ProgressIndicator fx:id="loading" visible="false" />
                            </StackPane>
                        </AnchorPane>
                    </VBox>

                    <!-- Top Places Chart -->
                    <VBox maxHeight="Infinity" maxWidth="Infinity" minHeight="450" minWidth="450" styleClass="section-card" HBox.hgrow="ALWAYS" VBox.vgrow="ALWAYS">
                        <HBox spacing="10">
                            <FontIcon iconLiteral="fas-chart-bar" iconSize="25" />
                            <Label styleClass="section-title" text="أفضل 5 أماكن تقييم" />
                        </HBox>
                        <AnchorPane VBox.vgrow="ALWAYS">
                            <StackPane fx:id="topPlacesChartHost" style="-fx-background-color: transparent;" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0">
                                <ProgressIndicator visible="false" />
                            </StackPane>
                        </AnchorPane>
                    </VBox>
                </HBox>

                <!-- Latest Reviews Table -->
                <VBox maxWidth="Infinity" minHeight="450" style="-fx-padding: 0 20 20 20;" styleClass="section-card" VBox.vgrow="ALWAYS">
                    <HBox alignment="CENTER_RIGHT" spacing="10">
                        <FontIcon iconLiteral="fas-clock" iconSize="25" />
                        <Label prefHeight="34.0" prefWidth="1150.0" styleClass="section-title" text="أحدث التعليقات" />
                    </HBox>

                    <AnchorPane VBox.vgrow="ALWAYS">
                        <TableView fx:id="reviewsTableView" fixedCellSize="34.0" minHeight="400" nodeOrientation="RIGHT_TO_LEFT" tableMenuButtonVisible="false" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0">
                            <columnResizePolicy>
                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                            </columnResizePolicy>

                            <placeholder>
                                <Label text="لا توجد تعليقات حالياً" />
                            </placeholder>

                            <columns>
                                <TableColumn minWidth="120" prefWidth="140" style="-fx-alignment: CENTER-RIGHT;" text="المستخدم">
                                    <cellValueFactory><PropertyValueFactory property="userName" /></cellValueFactory>
                                </TableColumn>
                                <TableColumn minWidth="150" prefWidth="180" style="-fx-alignment: CENTER-RIGHT;" text="المكان">
                                    <cellValueFactory><PropertyValueFactory property="placeName" /></cellValueFactory>
                                </TableColumn>
                                <TableColumn minWidth="260" prefWidth="400" style="-fx-alignment: CENTER-RIGHT;" text="التعليق">
                                    <cellValueFactory><PropertyValueFactory property="description" /></cellValueFactory>
                                </TableColumn>
                                <TableColumn minWidth="90" prefWidth="100" style="-fx-alignment: CENTER;" text="التقييم">
                                    <cellValueFactory><PropertyValueFactory property="rating" /></cellValueFactory>
                                </TableColumn>
                                <TableColumn minWidth="140" prefWidth="160" style="-fx-alignment: CENTER;" text="التاريخ">
                                    <cellValueFactory><PropertyValueFactory property="reviewDate" /></cellValueFactory>
                                </TableColumn>
                            </columns>
                        </TableView>
                    </AnchorPane>
                </VBox>

            </VBox>
        </content>
    </ScrollPane>

</AnchorPane>
